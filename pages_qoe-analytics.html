<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QoE Analytics - CS360</title>
    <link rel="stylesheet" href="../css/style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <span class="logo-icon">üìä</span>
                <span class="logo-text">CS360</span>
            </div>
            <ul class="nav-menu">
                <li><a href="../index.html" class="nav-link">Dashboard</a></li>
                <li><a href="sessions.html" class="nav-link">Sessions</a></li>
                <li><a href="qoe-analytics.html" class="nav-link active">QoE Analytics</a></li>
                <li><a href="customers.html" class="nav-link">Customers</a></li>
                <li><a href="alerts.html" class="nav-link">Alerts</a></li>
            </ul>
            <div class="nav-user">
                <span class="user-name">Admin</span>
                <span class="user-avatar">üë§</span>
            </div>
        </div>
    </nav>

    <!-- Main Container -->
    <div class="container">
        <!-- Header Section -->
        <header class="header">
            <h1>QoE Analytics</h1>
            <p>Detailed analysis of Quality of Experience metrics and trends</p>
        </header>

        <!-- KPI Cards -->
        <section class="metrics-grid">
            <div class="metric-card">
                <div class="metric-header">
                    <span class="metric-icon">‚≠ê</span>
                    <span class="metric-title">Average QoE Score</span>
                </div>
                <div class="metric-value">4.2</div>
                <div class="metric-trend trend-up">‚Üë 0.3 from last week</div>
            </div>

            <div class="metric-card">
                <div class="metric-header">
                    <span class="metric-icon">üìà</span>
                    <span class="metric-title">Excellent Experiences</span>
                </div>
                <div class="metric-value">70.6%</div>
                <div class="metric-trend trend-up">‚Üë 5% improvement</div>
            </div>

            <div class="metric-card">
                <div class="metric-header">
                    <span class="metric-icon">‚ö†Ô∏è</span>
                    <span class="metric-title">Poor Experiences</span>
                </div>
                <div class="metric-value">3.6%</div>
                <div class="metric-trend trend-down">‚Üì 2% improvement</div>
            </div>

            <div class="metric-card">
                <div class="metric-header">
                    <span class="metric-icon">üìä</span>
                    <span class="metric-title">Total Sessions Today</span>
                </div>
                <div class="metric-value">1,847</div>
                <div class="metric-trend trend-up">‚Üë 12% from yesterday</div>
            </div>
        </section>

        <!-- Charts Section -->
        <section class="charts-section">
            <!-- QoE Trend Over Time -->
            <div class="chart-container">
                <h2 class="chart-title">QoE Score Trend (Last 7 Days)</h2>
                <canvas id="qoeTrendChart"></canvas>
            </div>

            <!-- QoE Distribution -->
            <div class="chart-container">
                <h2 class="chart-title">QoE Category Distribution</h2>
                <canvas id="qoeCategoryChart"></canvas>
            </div>
        </section>

        <!-- Detailed Metrics Table -->
        <section style="background: white; padding: 2rem; border-radius: 8px; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); margin-bottom: 2rem;">
            <h2 style="color: #0283C2; margin-bottom: 1.5rem;">QoE Metrics by Location</h2>
            <div class="table-wrapper">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Location</th>
                            <th>Avg QoE</th>
                            <th>Sessions</th>
                            <th>Excellent</th>
                            <th>Good</th>
                            <th>Fair</th>
                            <th>Poor</th>
                            <th>Avg Latency</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Johannesburg</strong></td>
                            <td><span style="background: #E8F5E9; color: #4CAF50; padding: 0.25rem 0.5rem; border-radius: 4px; font-weight: 600;">4.4</span></td>
                            <td>456</td>
                            <td>82%</td>
                            <td>12%</td>
                            <td>4%</td>
                            <td>2%</td>
                            <td>48ms</td>
                        </tr>
                        <tr>
                            <td><strong>Cape Town</strong></td>
                            <td><span style="background: #E0F2F1; color: #00BFA4; padding: 0.25rem 0.5rem; border-radius: 4px; font-weight: 600;">3.9</span></td>
                            <td>392</td>
                            <td>68%</td>
                            <td>18%</td>
                            <td>10%</td>
                            <td>4%</td>
                            <td>75ms</td>
                        </tr>
                        <tr>
                            <td><strong>Durban</strong></td>
                            <td><span style="background: #FFF3E0; color: #FFC107; padding: 0.25rem 0.5rem; border-radius: 4px; font-weight: 600;">3.1</span></td>
                            <td>321</td>
                            <td>55%</td>
                            <td>25%</td>
                            <td>15%</td>
                            <td>5%</td>
                            <td>145ms</td>
                        </tr>
                        <tr>
                            <td><strong>Pretoria</strong></td>
                            <td><span style="background: #E8F5E9; color: #4CAF50; padding: 0.25rem 0.5rem; border-radius: 4px; font-weight: 600;">4.3</span></td>
                            <td>421</td>
                            <td>79%</td>
                            <td>14%</td>
                            <td>5%</td>
                            <td>2%</td>
                            <td>52ms</td>
                        </tr>
                        <tr>
                            <td><strong>Port Elizabeth</strong></td>
                            <td><span style="background: #E8F5E9; color: #4CAF50; padding: 0.25rem 0.5rem; border-radius: 4px; font-weight: 600;">4.5</span></td>
                            <td>257</td>
                            <td>85%</td>
                            <td>10%</td>
                            <td>3%</td>
                            <td>2%</td>
                            <td>38ms</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Device Type Analysis -->
        <section style="background: white; padding: 2rem; border-radius: 8px; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); margin-bottom: 2rem;">
            <h2 style="color: #0283C2; margin-bottom: 1.5rem;">QoE by Device Type</h2>
            <div class="table-wrapper">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Device Type</th>
                            <th>Avg QoE</th>
                            <th>Sessions</th>
                            <th>Network Avg</th>
                            <th>App Perf Avg</th>
                            <th>User Exp Avg</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>üì± Mobile</strong></td>
                            <td><span style="background: #E8F5E9; color: #4CAF50; padding: 0.25rem 0.5rem; border-radius: 4px; font-weight: 600;">4.1</span></td>
                            <td>1,120</td>
                            <td>4.2</td>
                            <td>3.9</td>
                            <td>4.2</td>
                        </tr>
                        <tr>
                            <td><strong>üñ•Ô∏è Desktop</strong></td>
                            <td><span style="background: #E8F5E9; color: #4CAF50; padding: 0.25rem 0.5rem; border-radius: 4px; font-weight: 600;">4.4</span></td>
                            <td>546</td>
                            <td>4.5</td>
                            <td>4.3</td>
                            <td>4.4</td>
                        </tr>
                        <tr>
                            <td><strong>üì± Tablet</strong></td>
                            <td><span style="background: #E0F2F1; color: #00BFA4; padding: 0.25rem 0.5rem; border-radius: 4px; font-weight: 600;">3.8</span></td>
                            <td>181</td>
                            <td>3.7</td>
                            <td>3.9</td>
                            <td>3.8</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Footer -->
        <footer class="footer">
            <p>&copy; 2025 CareStream360 (cs360). All rights reserved. | Last Updated: <span id="lastUpdate"></span></p>
        </footer>
    </div>

    <script src="../js/script.js"></script>
    <script src="../js/charts.js"></script>
    <script>
        // Initialize QoE Trend Chart
        document.addEventListener('DOMContentLoaded', function() {
            const trendCtx = document.getElementById('qoeTrendChart');
            if (trendCtx) {
                createQoETrendChart(trendCtx);
            }
            const categoryCtx = document.getElementById('qoeCategoryChart');
            if (categoryCtx) {
                createQoECategoryChart(categoryCtx);
            }
        });

        function createQoETrendChart(ctx) {
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
                    datasets: [{
                        label: 'Average QoE Score',
                        data: [3.8, 3.9, 4.0, 4.1, 4.2, 4.3, 4.2],
                        borderColor: '#0283C2',
                        backgroundColor: 'rgba(2, 131, 194, 0.05)',
                        borderWidth: 2,
                        tension: 0.4,
                        fill: true,
                        pointRadius: 4,
                        pointBackgroundColor: '#0283C2',
                        pointBorderColor: '#fff',
                        pointBorderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    scales: {
                        y: {
                            beginAtZero: true,
                            min: 0,
                            max: 5
                        }
                    }
                }
            });
        }

        function createQoECategoryChart(ctx) {
            new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Excellent', 'Good', 'Fair', 'Poor', 'Very Poor'],
                    datasets: [{
                        data: [70.6, 18.4, 6.8, 3.6, 0.6],
                        backgroundColor: ['#4CAF50', '#00BFA4', '#FFC107', '#FF9800', '#FF5252']
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true
                }
            });
        }
    </script>
</body>
</html>